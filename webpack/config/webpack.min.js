/*
 * @Description: 自定义 webpack 压缩配置
 * @Author: F-Stone
 * @Date: 2021-12-03 16:02:28
 * @LastEditTime: 2021-12-03 16:07:08
 * @LastEditors: F-Stone
 */

const TerserPlugin = require("terser-webpack-plugin");
const { IS_DEV_MODE } = require("./webpack.env");

exports.WEBPACK_MINIMIZE = {
    minimize: !IS_DEV_MODE,
    minimizer: [
        new TerserPlugin({
            test: /\.js(\?.*)?$/i,
            parallel: true,
            terserOptions: {
                // https://github.com/webpack-contrib/terser-webpack-plugin#terseroptions
                format: {
                    comments: false,
                },
                compress: {
                    arrows: false,
                    collapse_vars: false,
                    comparisons: false,
                    computed_props: false,
                    hoist_funs: false,
                    hoist_props: false,
                    hoist_vars: false,
                    inline: false,
                    loops: false,
                    negate_iife: false,
                    properties: false,
                    reduce_funcs: false,
                    reduce_vars: false,
                    switches: false,
                    toplevel: false,
                    typeofs: false,
                    booleans: true,
                    if_return: true,
                    sequences: true,
                    unused: true,
                    conditionals: true,
                    dead_code: true,
                    evaluate: true,
                    drop_console: true,
                    drop_debugger: true,
                },
                mangle: {
                    safari10: true,
                },
            },
        }),
    ],
};
